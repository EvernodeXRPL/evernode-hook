#ifndef TRANSACTIONS_INCLUDED
#define TRANSACTIONS_INCLUDED 1

// Mint NFT

uint8_t REG_NFT_MINT_TX[279] = {
    0x12, 0x00, 0x19,                                     // transaction_type(ttNFT_MINT)
    0x14, 0x00, 0x00,                                     // transfer_fee(0)
    0x22, 0x00, 0x00, 0x00, 0x01,                         // flags(tfBurnable)
    0x24, 0x00, 0x00, 0x00, 0x00,                         // sequence(0)
    0x20, 0x1A, 0x00, 0x00, 0x00, 0x00,                   // first_ledger_sequence(ledger_seq + 1) - Added on prepare to offset 18
    0x20, 0x1B, 0x00, 0x00, 0x00, 0x00,                   // last_ledger_sequence(ledger_seq + 5) - Added on prepare to offset 24
    0x20, 0x2A, 0x00, 0x00, 0x00, 0x00,                   // taxon(0)
    0x68, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // fee - Added on prepare to offset 34
    0x73, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // signing pubkey(NULL)
    0x75, 0x27, 0x65, 0x76, 0x72, 0x68, 0x6F, 0x73, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, // uri(length 39, evrhost<txid>) - txid Added on prepare to offset 87
    0x81, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // account - Added on prepare to offset 121
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // emit details(138 bytes) - Added on prepare to offset 141
};

uint8_t NFT_BURN_TX[284] = {
    0x12, 0x00, 0x1A,                   // transaction_type(ttNFT_BURN)
    0x22, 0x00, 0x00, 0x00, 0x00,       // flags(0)
    0x24, 0x00, 0x00, 0x00, 0x00,       // sequence(0)
    0x20, 0x1A, 0x00, 0x00, 0x00, 0x00, // first_ledger_sequence(ledger_seq + 1) - Added on prepare to offset 15
    0x20, 0x1B, 0x00, 0x00, 0x00, 0x00, // last_ledger_sequence(ledger_seq + 5) - Added on prepare to offset 21
    0x5A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // nftokenid - Added on prepare to offset 26
    0x68, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,                         // fee - Added on prepare to offset 58
    0x73, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // signing pubkey(NULL)
    0x81, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // account - Added on prepare to offset 104
    0x82, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // owner - Added on prepare to offset 126
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // emit details(138) - Added on prepare to offset 160
};

// Offer Trustline
uint8_t _NFT_BUY_OFFER_TRUSTLINE[338] = {
    0x12, 0x00, 0x1B,                   // transaction_type(ttNFT_OFFER)
    0x22, 0x00, 0x00, 0x00, 0x00,       // Flags (tfBuyToken)
    0x24, 0x00, 0x00, 0x00, 0x00,       // sequence(0)
    0x2A, 0xFF, 0xFF, 0xFF, 0xFF,       // expiration_max
    0x20, 0x1A, 0x00, 0x00, 0x00, 0x00, // first_ledger_sequence(ledger_seq + 1) - Added on prepare to offset 20
    0x20, 0x1B, 0x00, 0x00, 0x00, 0x00, // last_ledger_sequence(ledger_seq + 5) - Added on prepare to offset 26
    0x61, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x56, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xDA, 0xD1, 0xA1, 0x58, 0x2D, 0x0C, 0xC4, 0x8B, 0xF7, 0x63, 0xA4, 0x85, 0xB8, 0x87, 0xDD, 0x76, 0xA4, 0x4D, 0x6C, 0xB8, // amount(<type(1)><amount(8)><currency_code(20)><issuer(20)>) - Added on prepare to offset 31
    0x5A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // NFTokenID - Added on prepare to offset 80
    0x68, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,                         // fee - Added on prepare to offset 112
    0x73, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // signing pubkey(NULL)
    0x81, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // AccountID - Added on prepare to offset 158
    0x82, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // AccountID owner - Added on prepare to offset 180
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // emit details(138) - Added on prepare to offset 200
};

// Offers (BUY/SELL)
uint8_t _NFT_OFFER[298] = {
    0x12, 0x00, 0x1B,                                     // transaction_type(ttNFT_OFFER)
    0x22, 0x00, 0x00, 0x00, 0x00,                         // Flags (tfBuyToken/tfSellToken) - Added on prepare to offset 4
    0x24, 0x00, 0x00, 0x00, 0x00,                         // sequence(0)
    0x2A, 0xFF, 0xFF, 0xFF, 0xFF,                         // expiration_max
    0x20, 0x1A, 0x00, 0x00, 0x00, 0x00,                   // first_ledger_sequence(ledger_seq + 1) - Added on prepare to offset 20
    0x20, 0x1B, 0x00, 0x00, 0x00, 0x00,                   // last_ledger_sequence(ledger_seq + 5) - Added on prepare to offset 26
    0x61, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // amount(<type(1)><amount(8)>) - Added on prepare to offset 31
    0x5A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // NFTokenID - Added on prepare to offset 40
    0x68, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,                         // fee - Added on prepare to offset 72
    0x73, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // signing pubkey(NULL)
    0x81, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // AccountID - Added on prepare to offset 118
    0x82, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, // AccountID owner - Added on prepare to offset 140
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // emit details(138) - Added on prepare to offset 160
};

#define REG_NFT_MINT_TX_SIZE \
    sizeof(REG_NFT_MINT_TX)
#define PREPARE_REG_NFT_MINT_TX(txid)                               \
    {                                                               \
        uint8_t *buf_out = REG_NFT_MINT_TX;                         \
        UINT32_TO_BUF((buf_out + 18), cur_ledger_seq + 1);          \
        UINT32_TO_BUF((buf_out + 24), cur_ledger_seq + 5);          \
        COPY_32BYTES((buf_out + 87), txid);                         \
        COPY_20BYTES((buf_out + 121), hook_accid);                  \
        etxn_details((buf_out + 141), 138);                         \
        int64_t fee = etxn_fee_base(buf_out, REG_NFT_MINT_TX_SIZE); \
        uint8_t *fee_ptr = buf_out + 34;                            \
        CHECK_AND_ENCODE_FINAL_TRX_FEE(fee_ptr, fee);               \
    }

#define NFT_BURN_TX_SIZE \
    sizeof(NFT_BURN_TX)
#define PREPARE_NFT_BURN_TX(nftid, owner)                       \
    {                                                           \
        uint8_t *buf_out = NFT_BURN_TX;                         \
        UINT32_TO_BUF((buf_out + 15), cur_ledger_seq + 1);      \
        UINT32_TO_BUF((buf_out + 21), cur_ledger_seq + 5);      \
        COPY_32BYTES((buf_out + 26), nftid);                    \
        COPY_20BYTES((buf_out + 104), hook_accid);              \
        COPY_20BYTES((buf_out + 126), owner);                   \
        etxn_details((buf_out + 146), 138);                     \
        int64_t fee = etxn_fee_base(buf_out, NFT_BURN_TX_SIZE); \
        uint8_t *fee_ptr = buf_out + 58;                        \
        CHECK_AND_ENCODE_FINAL_TRX_FEE(fee_ptr, fee);           \
    }

#define NFT_BUY_OFFER_TRUSTLINE_TX_SIZE \
    sizeof(_NFT_BUY_OFFER_TRUSTLINE)
#define PREPARE_NFT_BUY_OFFER_TRUSTLINE_TX(tlamt, to_address, tknid)           \
    {                                                                          \
        uint8_t *buf_out = _NFT_BUY_OFFER_TRUSTLINE;                           \
        UINT32_TO_BUF((buf_out + 20), cur_ledger_seq + 1);                     \
        UINT32_TO_BUF((buf_out + 26), cur_ledger_seq + 5);                     \
        COPY_40BYTES((buf_out + 31), tlamt);                                   \
        COPY_8BYTES((buf_out + 71), (tlamt + 40));                             \
        COPY_32BYTES((buf_out + 80), tknid)                                    \
        COPY_20BYTES((buf_out + 158), hook_accid);                             \
        COPY_20BYTES((buf_out + 180), to_address);                             \
        etxn_details((uint32_t)buf_out + 200, 138);                            \
        int64_t fee = etxn_fee_base(buf_out, NFT_BUY_OFFER_TRUSTLINE_TX_SIZE); \
        uint8_t *fee_ptr = buf_out + 112;                                      \
        CHECK_AND_ENCODE_FINAL_TRX_FEE(fee_ptr, fee);                          \
    }

#define NFT_OFFER_TX_SIZE \
    sizeof(_NFT_OFFER)
#define PREPARE_NFT_BUY_OFFER_TX(drops_amount_raw, to_address, tknid) \
    {                                                                 \
        uint8_t *buf_out = _NFT_OFFER;                                \
        UINT32_TO_BUF((buf_out + 4), tfBuyToken);                     \
        UINT32_TO_BUF((buf_out + 20), cur_ledger_seq + 1);            \
        UINT32_TO_BUF((buf_out + 26), cur_ledger_seq + 5);            \
        uint8_t *buf_ptr = buf_out + 30;                              \
        _06_01_ENCODE_DROPS_AMOUNT(buf_ptr, drops_amount_raw);        \
        COPY_32BYTES((buf_out + 40), tknid)                           \
        COPY_20BYTES((buf_out + 118), hook_accid);                    \
        *(buf_out + 138) = 0x82;                                      \
        COPY_20BYTES((buf_out + 140), to_address);                    \
        etxn_details((uint32_t)buf_out + 160, 138);                   \
        int64_t fee = etxn_fee_base(buf_out, NFT_OFFER_TX_SIZE);      \
        buf_ptr = buf_out + 72;                                       \
        CHECK_AND_ENCODE_FINAL_TRX_FEE(buf_ptr, fee);                 \
    }

#define PREPARE_NFT_SELL_OFFER_TX(drops_amount_raw, to_address, tknid) \
    {                                                                  \
        uint8_t *buf_out = _NFT_OFFER;                                 \
        UINT32_TO_BUF((buf_out + 4), tfSellToken);                     \
        UINT32_TO_BUF((buf_out + 20), cur_ledger_seq + 1);             \
        UINT32_TO_BUF((buf_out + 26), cur_ledger_seq + 5);             \
        uint8_t *buf_ptr = buf_out + 30;                               \
        _06_01_ENCODE_DROPS_AMOUNT(buf_ptr, drops_amount_raw);         \
        COPY_32BYTES((buf_out + 40), tknid)                            \
        COPY_20BYTES((buf_out + 118), hook_accid);                     \
        *(buf_out + 138) = 0x83;                                       \
        COPY_20BYTES((buf_out + 140), to_address);                     \
        etxn_details((uint32_t)buf_out + 160, 138);                    \
        int64_t fee = etxn_fee_base(buf_out, NFT_OFFER_TX_SIZE);       \
        buf_ptr = buf_out + 72;                                        \
        CHECK_AND_ENCODE_FINAL_TRX_FEE(buf_ptr, fee);                  \
    }

#endif